# Project Management System Guide

## Overview

This guide documents the hierarchical project management (PM) system used in the Task Similarity Analysis project. The system is designed for **context-efficient** work tracking across multiple components while maintaining comprehensive historical records.

## Core Principles

### 1. Hierarchical Structure
- **Root Level**: `PM_snapshot.md` (auto-generated overview)
- **Component Level**: `PM_ongoing.md` (detailed work tracking)
- **Historical Level**: `PM_history.md` (migrated work items)

### 2. Context Efficiency
- **Never manually edit** `PM_snapshot.md` - always auto-generated
- **Rolling window**: `PM_ongoing.md` keeps only 15 most recent work items
- **Automated migration**: Excess items move to `PM_history.md`
- **Load PM_history.md only for debugging** - prevents context bloat

### 3. Registry-Based Management
- All component PM files listed in `CLAUDE.md` registry
- Automated tools work from registry for consistency
- Fallback file discovery if registry unavailable

## File Structure

### Root Level: `PM_snapshot.md`
**Never manually edit** - always auto-generated from component PM files.

```markdown
# PM SNAPSHOT - [Project Name]

*High-level project overview auto-constructed from component PM files*
*Last updated: 2025-06-03 15:29*

## PM Summary
**Tracked PM Files**: N component PM_ongoing.md files
**Component Paths**:
- `component1/PM_ongoing.md`
- `component2/PM_ongoing.md`

## Project Components

### 1. Component Name (`component1/`)
- **PM File**: [component1/PM_ongoing.md](./component1/PM_ongoing.md)
- **High Level Tasks**:
  - Task 1 Description
  - Task 2 Description
- **Status**: ‚úÖ ACTIVE (N recent work items)

<!-- Auto-generated by scripts/pm_update.py on timestamp -->
```

### Component Level: `PM_ongoing.md`
Three-section structure for detailed work tracking:

```markdown
# PM ONGOING - [Component Name]

## High Level Tasks

### 1. [Task Name]
- **Description**: [Strategic objective description]
- **Status**: [üéØ NEXT PRIORITY | ‚úÖ PRODUCTION READY | ‚ö†Ô∏è BLOCKED]

### 2. [Another Task]
- **Description**: [Strategic objective description]  
- **Status**: [Status with context]

## Recent Work (Last 15 Items)

### 2025-06-03
1. **[Work Item Title]** - [Brief description]
   - [Detailed bullet points of what was accomplished]
   - [Technical details, decisions made, etc.]
   - [Links to files changed or created]

2. **[Another Work Item]** - [Brief description]
   - [Implementation details]
   - [Results achieved]

## Context Scratchpad

### [Section Name]
- **[Key Information]**: [Persistent details needed for ongoing work]
- **[Commands]**: [Critical commands for this component]
- **[Technical Notes]**: [Important technical context]
```

### Historical Level: `PM_history.md`
**Auto-generated during migrations** - contains chronological work history:

```markdown
# PM HISTORY - [Component Name]

## Migrated Items - 2025-06-03
[Migrated work items from PM_ongoing.md when it exceeded 15 items]

## Migrated Items - 2025-05-28
[Earlier migrated items]
```

## Registry System

### CLAUDE.md Registry Section
Add this section to your project's `CLAUDE.md`:

```markdown
### Distributed PM Files Registry
**IMPORTANT**: All component PM_ongoing.md files must be listed here for automated processing:
- `component1/PM_ongoing.md` - Component 1 description
- `component2/PM_ongoing.md` - Component 2 description
```

### Registry Commands
The PM update script reads from this registry for all operations:

```bash
python scripts/pm_update.py --check                          # Check all component PM files from registry
python scripts/pm_update.py --verify                         # Verify and auto-adjust all PM files from registry
python scripts/pm_update.py --migrate component1/            # Migrate specific component  
python scripts/pm_update.py --migrate-all                    # Migrate all components needing it
python scripts/pm_update.py --rebuild-snapshot               # Reconstruct PM_snapshot.md from components
python scripts/pm_update.py --full-update                    # Complete workflow: verify + rebuild snapshot
python scripts/pm_update.py --full-update --dry-run          # Preview complete workflow without executing
```

## Implementation Guide

### Step 1: Create the PM Update Script

Save this as `scripts/pm_update.py`:

```python
#!/usr/bin/env python3
"""
PM Update Script for [Your Project Name]

Manages the hierarchical PM structure:
1. Migrates work items from component PM_ongoing.md files to PM_history.md when exceeding 15 items
2. Reconstructs PM_snapshot.md from component PM_ongoing.md high-level tasks

[Copy the full script content from the source file]
"""
```

Make it executable:
```bash
chmod +x scripts/pm_update.py
```

### Step 2: Set Up PM Files

1. **Create component PM_ongoing.md files** in each major component directory
2. **Add registry entries** to your `CLAUDE.md` file
3. **Initialize PM_snapshot.md** by running:
   ```bash
   python scripts/pm_update.py --rebuild-snapshot
   ```

### Step 3: Establish Workflow

1. **Start work**: Update relevant `PM_ongoing.md` file
2. **During work**: Add items to Recent Work section
3. **When >15 items**: Run `python scripts/pm_update.py --migrate component/`
4. **Regular maintenance**: Run `python scripts/pm_update.py --full-update`

## Usage Patterns

### For Claude Code
- **Load `PM_snapshot.md` first** - get high-level project status
- **Load specific `PM_ongoing.md`** - get detailed component context  
- **Avoid loading `PM_history.md`** - only for debugging complex issues
- **Update `PM_ongoing.md`** when working on components
- **Run migration** when Recent Work exceeds 15 items

### Status Indicators
- **üéØ NEXT PRIORITY** - Immediate focus areas
- **‚úÖ PRODUCTION READY** - Completed, stable components
- **‚ö†Ô∏è BLOCKED** - Waiting on dependencies
- **üîÑ IN PROGRESS** - Active development

### Work Item Format
```markdown
N. **[Descriptive Title]** - [Brief summary]
   - [Detailed implementation notes]
   - [Technical decisions made]
   - [Files modified/created]
   - [Results achieved]
```

## Migration Workflow

### When Recent Work Exceeds 15 Items

1. **Automatic Detection**:
   ```bash
   python scripts/pm_update.py --check
   ```

2. **Migrate Specific Component**:
   ```bash
   python scripts/pm_update.py --migrate component/
   ```

3. **Auto-rebuild Snapshot**:
   - PM_snapshot.md automatically updates after migrations
   - Keeps high-level view current

### Full Maintenance
```bash
python scripts/pm_update.py --full-update
```
This command:
1. Checks all components from registry
2. Migrates any exceeding 15 items  
3. Rebuilds PM_snapshot.md
4. Reports all changes made

## Benefits

### Context Efficiency
- **Bounded context**: PM_ongoing.md never exceeds ~15 items
- **Focused reading**: Only load what's needed for current work
- **Historical access**: Full history available but separate

### Automation
- **No manual tracking** of item counts
- **Consistent structure** across components
- **Auto-generated overview** stays current

### Scalability
- **Distributed components** each manage their own PM
- **Registry-based coordination** for project-wide views
- **Independent migration** schedules per component

## Customization

### Component Information
Edit the `component_info` dictionary in `pm_update.py`:

```python
component_info = {
    'your-component-path': {
        'name': 'Component Display Name',
        'path': 'your-component-path/',
        'description': 'Component description for PM_snapshot.md'
    }
}
```

### Status Indicators
Customize the status parsing in `extract_high_level_tasks()` function to match your project's status conventions.

### Migration Triggers
The 15-item limit can be adjusted by changing the condition in `parse_pm_ongoing()` and related functions.

## Integration with Other Projects

### Minimal Setup
1. Copy `scripts/pm_update.py` to your project
2. Add registry section to your project's `CLAUDE.md`
3. Create initial component `PM_ongoing.md` files
4. Initialize with `python scripts/pm_update.py --rebuild-snapshot`

### Adaptation
- Modify component paths and names for your project structure
- Adjust status indicators to match your workflow
- Customize the PM_snapshot.md template in `reconstruct_pm_snapshot()`

## Best Practices

### Do
- ‚úÖ Use descriptive work item titles
- ‚úÖ Include technical details in work items
- ‚úÖ Run regular maintenance (`--full-update`)
- ‚úÖ Keep High Level Tasks strategic and high-level
- ‚úÖ Use Context Scratchpad for persistent technical info

### Don't
- ‚ùå Manually edit PM_snapshot.md
- ‚ùå Load PM_history.md unless debugging
- ‚ùå Let Recent Work exceed 20+ items without migration
- ‚ùå Put low-level details in High Level Tasks
- ‚ùå Forget to update registry when adding components

This system provides efficient, scalable project management that grows with your project while maintaining context efficiency for AI assistance.